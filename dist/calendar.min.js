!function(e){var t="undefined"!=typeof window?window:this;"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t):function(t){if(!t.document)throw new Error("document is a undefined");return e(t)}:e(t)}(function(e){function t(){var e=new Date;this.past=!1,this.hours=!1,this.hoursPast=!1,this.currentNode=null,this.minDate=null,this.maxDate=null,this.shield="[]",this.startDate="",this.startJSON={},this.fixDate={y:e.getFullYear(),m:e.getMonth()+1,d:0},this.init()}function a(e,t){function a(a){function n(e){if(L)return!1;var a=e.targetTouches?e.targetTouches[0]:e||event;return i=a.pageX-o,Math.abs(i)>=d&&(L=!0,t&&t(c,i)),a.preventDefault&&a.preventDefault(),!1}function r(){this.onmousemove&&(this.onmousemove=null),this.onmouseup&&(this.onmouseup=null),this.removeEventListener("touchmove",n,!1),this.removeEventListener("touchend",r,!1),L=!1}var i,s=a.targetTouches?a.targetTouches[0]:a||event,o=s.pageX,d=parseInt(document.documentElement.clientWidth/5,10),c=this;this.onmousemove=n,this.onmouseup=r,e.removeEventListener("touchmove",n,!1),e.removeEventListener("touchend",r,!1),e.addEventListener("touchmove",n,!1),e.addEventListener("touchend",r,!1)}e.onmousedown=a,e.removeEventListener("touchstart",a,!1),e.addEventListener("touchstart",a,!1)}function n(e,t,a){return void 0===e||void 0===t||void 0===a?null:new Date(e,t,a,23,59,59).getTime()}function r(e,t){switch(t.charAt(0)){case"#":return e.querySelector(t);case".":return e.querySelectorAll(t);default:return e.querySelectorAll(t)}}function i(e,t,a){if(e){t=t||{},a=a||"";var n=document.createElement(e);for(var r in t)n.setAttribute(r,t[r]);return n.innerHTML=a,n}}function s(){N.classList.add("close"),setTimeout(function(){N.classList.remove("active","close")},290)}function o(e,t){if(!e)return!1;var a=t||"y/m/d",n=e.split("/"),r=(a.match(/[^a-z\d]/i)[0],{y:n[0],m:c(n[1]),d:c(n[2])});return a.replace(/yyyy/i,r.y).replace(/mm/i,r.m).replace(/dd/i,r.d)}function d(e){if(!e)return[];var t=[];return/^\[|\]$/.test(e)?t=JSON.parse(e.replace(/\'/g,'"')):/^\d+[\/-]\d+[\/-]\d+$/.test(e)&&(t=[e]),t.map(function(e){var t=new Date(e+" 23:59:59");return{y:t.getFullYear(),m:t.getMonth()+1,d:t.getDate()}})}function c(e){return Number(e)<10?"0"+e:e}function l(e,t,a){switch(arguments.length){case 3:e.setAttribute(t,a);break;case 2:return e.getAttribute(t)}}var h,u,v,p,f,m,y,g=0,D=0,L=!1,N=i("div",{"class":"calendar"}),w=i("div",{"class":"calendar-mask"}),x=i("div",{"class":"calendar-content"}),C=i("div",{"class":"calendar-list"});return t.prototype.init=function(){function e(e){if(e.preventDefault(),e.stopPropagation(),null==l(this,"disabled")){var n=Number(l(this,"start-year"))||1915,r=Number(l(this,"end-year"))||2050;t.hours=!(null==l(this,"hours")),t.hoursPast=!(null==l(this,"hours-past")),t.past=!(null==l(this,"past"))||t.hoursPast,t.minDate=d(l(this,"min-date")||"")[0],t.maxDate=d(l(this,"max-date")||"")[0],t.shield=d(l(this,"shield")||""),t.startDate=d(l(this,"start-date")||"");var i,s,o,c=new Date;if(t.startDate instanceof Array&&t.startDate.length){var h=t.startDate[0];D=h.y-c.getFullYear(),g=h.m-(c.getMonth()+1);for(var u in h)t.fixDate[u]=h[u];i={y:D,m:g-1,d:h.d},s={y:D,m:g,d:h.d},o={y:D,m:g+1,d:h.d},t.startJSON={prev:i,now:s,next:o}}else t.fixDate.y=c.getFullYear(),t.fixDate.m=c.getMonth()+1,t.fixDate.d=0;t.currentNode!=this&&((!t.startDate instanceof Array||!t.startDate)&&(D=g=0,t.startJSON.prev={y:D,m:g-1},t.startJSON.now={y:D,m:g},t.startJSON.next={y:D,m:g+1}),t.appendList(t.startJSON,t.addEvent.bind(t)),t.createDate({start:n,end:r,type:"year"},function(e){for(var n=0;n<e.length;n++)e[n].onclick=function(){for(var a=0;a<e.length;a++)e[a].classList.remove("active");D+=l(this,"data-value")-l(p,"data-value"),t.selectDate(this,m,"y",D)};a(m,function(e,t){m.index=m.index||0;var a=m.children.length;t>0?(m.index++,m.index>=0&&(m.index=0)):(m.index--,m.index<=-a&&(m.index=-(a-1)));var n="translate3D("+m.index*(100/a)+"%, 0, 0)";m.style.WebkitTransform=n,m.style.transform=n})})),N.classList.add("active"),t.currentNode=this}}var t=this,n=document.querySelectorAll(".calendars");if(n.length){N.appendChild(w),N.appendChild(x),document.body.appendChild(N),this.createHeader(function(){this.createWeek(),x.appendChild(C),a(C,function(e,t){t>0?g--:g++,this.startJSON.prev.m=g-1,this.startJSON.now.m=g,this.startJSON.next.m=g+1,this.transitions(e,t)}.bind(this)),h.forEach(function(e){e.onclick=function(){this.classList.contains("calendar-month-txt")?(y.classList.toggle("active"),m.show&&(m.show=!1,m.classList.remove("active")),u.forEach(function(e){l(e,"data-value")===l(this,"data-value")?e.classList.add("active"):e.classList.remove("active")}.bind(this)),y.show=!y.show):this.classList.contains("calendar-year-txt")&&(m.classList.toggle("active"),y.show&&(y.classList.remove("active"),y.show=!1),v.forEach(function(e){var t=e.classList;l(e,"data-value")===l(this,"data-value")?t.add("active"):t.remove("active")}.bind(this)),m.show=!m.show)}})}.bind(this)),this.createDate({},function(e){for(var a=0;a<u.length;a++)e[a].onclick=function(){for(var a=0;a<e.length;a++)e[a].classList.remove("active");g+=l(this,"data-value")-l(f,"data-value"),t.selectDate(this,y,"m",g)}});for(var r=0;r<n.length;r++)l(n[r],"readonly","true"),n[r].removeEventListener("focus",e,!1),n[r].addEventListener("focus",e,!1),l(n[r],"format")||l(n[r],"format","yyyy-mm-dd"),l(n[r],"daterange","true");x.onclick=function(e){var t=e.targetTouches?e.targetTouches[0]:e||event;t.cancelBubble=!0},w.onclick=function(){t.currentNode.oldValue?t.currentNode&&"true"===l(t.currentNode,"daterange")&&t.currentNode.oldValue.split(",").length>=2&&s():s()}}},t.prototype.createCalenList=function(e,t){function a(e,t,a){if(!r.shield)return!1;for(var n=0;n<r.shield.length;n++)if(r.shield[n].y=r.shield[n].y||v.getFullYear(),r.shield[n].m=r.shield[n].m||v.getMonth()+1,r.shield[n].d=r.shield[n].d||v.getDate(),e==r.shield[n].y&&t==r.shield[n].m&&a==r.shield[n].d)return!0;return!1}var r=this,s=document.createElement("div"),o=0,d=e.y||0,c=e.m||0,h=(e.d,this.minDate||{}),u=this.maxDate||{},v=new Date;v.setFullYear(v.getFullYear()+d,v.getMonth()+c+1,1),v.setDate(0);var m=v.getDate();v.setDate(1);var y=v.getDay(),v=new Date,g=v.getDate();v.setFullYear(v.getFullYear()+d,v.getMonth()+c,1);var D=v.getFullYear(),L=v.getMonth()+1;v.setDate(0);for(var N=v.getDate(),w=[],x=N;x>0;x--)w.push(x);t&&(p.innerHTML=D,f.innerHTML=L<10?"0"+L:L,l(p,"data-value",D),l(f,"data-value",L-1));var C=y+7;C=C>=10?C-7:C;for(var x=0;x<C;x++){var b=i("span"),S=i("a",{"data-calen":[D,L-1,w[x]].join("/"),"class":"prev-m prev-to-month pasted",href:"javascript:;"},w[x]);b.appendChild(S),0!==s.children.length?s.insertBefore(b,s.children[0]):s.appendChild(b),o++}for(var k=n(D,L,g),j=n(h.y,h.m,h.d),T=n(u.y,u.m,u.d),x=0;x<m;x++){o++;var E=x+1,b=i("span"),S=i("a",{"data-calen":[D,L,E].join("/"),href:"javascript:;"},E);new Date;o%7!==0&&o%7!==1||S.classList.add("weekend");var O=n(d+D,c+L,E),J=n(D,L,E);if((r.past&&O<k||j&&J<j||T&&J>T)&&S.classList.add("expire","pasted"),(O===k||r.fixDate.y===D&&r.fixDate.m===L&&r.fixDate.d===E)&&S.classList.add("today"),r.currentNode&&r.currentNode.oldValue){var M=l(S,"data-calen").replace(/\//g,"-"),H=M.split("-");H[1]<10&&(H[1]="0"+H[1]),H[2]<10&&(H[2]="0"+H[2]),M=H.join("-"),r.currentNode.oldValue.indexOf(M)>-1&&S.classList.add("markDate")}a(D,L,E)&&S.classList.add("pasted","shield"),b.appendChild(S),s.appendChild(b)}for(var V=42-s.children.length,x=0;x<V;x++){var E=x+1,b=i("span"),S=i("a",{"data-calen":[D,L+1,E].join("/"),"class":"next-m next-to-month pasted",href:"javascript:;"},E);b.appendChild(S),s.appendChild(b)}return s},t.prototype.createDate=function(e,t){e=e||{},e.start=e.start||1,e.end=e.end||12,e.type=e.type||"month";for(var a=i("div",{"class":"month"==e.type?"calendar-months":"calendar-years"}),n=i("div"),r=[],s=0,o=0,d=0,c=(new Date).getFullYear(),l=e.start;l<=e.end;l++){var h=i("span"),p=i("a",{"data-value":"year"==e.type?l:l-1,href:"javascript:;"},l<10?"0"+l:l);r.push(p),"year"==e.type?(s>=12&&(a.appendChild(n),n=i("div"),s=0,o++),l==c&&(d=o),h.appendChild(p),n.appendChild(h)):(h.appendChild(p),a.appendChild(h)),s++}if("year"==e.type){m&&x&&x.removeChild(m),a.appendChild(n),m=a,v=r,s&&o++,a.style.width=100*o+"%";for(var l=0;l<o;l++)a.children[l].style.width=100/o+"%";a.style.WebkitTransform="translate3D(-"+d*(100/o)+"%, 0, 0)",a.style.transform="translate3D(-"+d*(100/o)+"%, 0, 0)",m.index=-d}else y&&x&&x.removeChild(y),y=a,u=r;x.appendChild(a),t&&t(r)},t.prototype.createTime=function(e,t,a){var n=r(x,".calendar-time"),o=[],d=new Date,c=d.getDate(),h=d.getHours(),u=this;if(n.length){n=n[0];for(var v=r(n,"a"),p=0;p<v.length;p++)o.push({obj:v[p],time:parseInt(l(v[p],"data-time"),10)})}else{n=i("div",{"class":"calendar-time"});for(var p=0;p<24;p++){var f=p<10?"0"+p:p;f+=":00";var m=i("span"),y=i("a",{href:"javascript:;","data-time":f},f);m.appendChild(y),n.appendChild(m),o.push({obj:y,time:parseInt(f,10)})}}n.classList.add("active"),o.forEach(function(r){u.hoursPast&&(g<0&&D<=0||a==c&&r.time<=h||g<=0&&D<=0&&a<c)?(r.obj.classList.add("expire","pasted"),r.obj.active=!1):(r.obj.classList.remove("expire","pasted"),r.obj.active=!0),r.obj.onclick=function(){if(this.active){var a=t+" "+(r.time<10?"0"+r.time:r.time)+":00";null!==e.value?e.value=a:null!=e.innerHTML&&(e.innerHTML=a),s(),u.changes()}n.classList.remove("active")}}),x.appendChild(n)},t.prototype.createHeader=function(e){h=h||[];var t=this,a=i("div",{"class":"calendar-header"}),n=i("div",{"class":"calendar-year"}),r=i("a",{"class":"year-prev switch-btn",href:"javascript:;"},"&lt;"),s=i("a",{"class":"year-next switch-btn",href:"javascript:;"},"&gt;"),o=i("a",{"class":"calendar-year-txt calendar-title",href:"javascript:;"});n.appendChild(r),n.appendChild(o),n.appendChild(s);var d=i("div",{"class":"calendar-month"}),c=i("a",{"class":"month-prev switch-btn",href:"javascript:;"},"&lt;"),l=i("a",{"class":"month-next switch-btn",href:"javascript:;"},"&gt;"),u=i("a",{"class":"calendar-month-txt calendar-title",href:"javascript:;"});d.appendChild(c),d.appendChild(u),d.appendChild(l),a.appendChild(n),a.appendChild(d),h.push(o,u),f=u,p=o,c.onclick=function(){t.switchDate(-1)},l.onclick=function(){t.switchDate(1)},r.onclick=function(){t.switchDate(-1,"year")},s.onclick=function(){t.switchDate(1,"year")};var v=document.querySelector(".calendar-header");v&&x.removeChild(v),x.children.length?x.insertBefore(a,x.children[0]):x.appendChild(a);for(var m=0;m<a.children.length;m++)a.children[m].ontouchstart=function(){this.classList.add("active")},a.children[m].ontouchend=function(){this.classList.remove("active")};e&&e()},t.prototype.createWeek=function(){for(var e=i("div",{"class":"calendar-week"}),t="日一二三四五六",a=0;a<7;a++){var n=a+1,r={};n%7!=1&&n%7!=0||(r["class"]="weekend"),e.appendChild(i("span",r,t.charAt(a)))}var s=document.querySelector(".calendar-week");s&&x.removeChild(s),x.appendChild(e)},t.prototype.appendList=function(e,t){e=e||{},e.prev=e.prev||{m:g-1,y:D},e.now=e.now||{m:g,y:D},e.next=e.next||{m:g+1,y:D},C.innerHTML="",C.appendChild(this.createCalenList(e.prev)),C.appendChild(this.createCalenList(e.now,!0)),C.appendChild(this.createCalenList(e.next)),t&&t()},t.prototype.addEvent=function(){var e=this,t=[];Array.prototype.forEach.call(C.querySelectorAll("a"),function(a){a.onclick=function(){var a=this.classList;if(a.contains("prev-to-month"))e.switchDate(-1);else if(a.contains("next-to-month"))e.switchDate(1);else if(!a.contains("pasted")&&!a.contains("shield")){var n=l(this,"data-calen"),r=o(n,l(e.currentNode,"format")||!1);if(r){this.classList.add("markDate");var i=C.querySelectorAll(".markDate");if("true"===l(e.currentNode,"daterange")){if(i.length>2||e.currentNode.oldValue&&e.currentNode.oldValue.split(",").length>=2){e.currentNode.oldValue=void 0,e.changes();for(var d=0;d<i.length;d++)i[d].innerText!==this.innerHTML&&i[d].classList.remove("markDate")}}else for(var d=0;d<i.length;d++)i[d].innerText!==this.innerHTML&&i[d].classList.remove("markDate");e.currentNode.oldValue&&e.currentNode.oldValue.split(",").length<2?(t=[],t.push(e.currentNode.oldValue,r)):t.push(r)}if(e.hours){var c=this.innerHTML;e.createTime(e.currentNode,r,c)}else if(e.currentNode&&(void 0===e.currentNode.value?e.currentNode.innerHTML=r:e.currentNode.oldValue!==r&&(e.currentNode.value=r,e.currentNode.oldValue=r,e.changes())),"true"===l(e.currentNode,"daterange")){if(t[0]>t[1]){var h=t[0],u=t[1];h=[u,u=h][0],t=[h,u]}e.currentNode.innerHTML=t,e.currentNode.value=t,e.currentNode.oldValue=t.join(","),e.changes(),t.length>=2?(t.splice(0,2),s()):e.currentNode.oldValue=r}else s()}}})},t.prototype.switchDate=function(e,t){var a=this;switch(t=t||"month"){case"month":e>0?g++:g--,a.startJSON.prev.m=g-1,a.startJSON.now.m=g,a.startJSON.next.m=g+1,a.transitions(C,e>0?-1:1);break;case"year":a.appendList({prev:{m:g,y:D-1},next:{m:g,y:D+1}},function(){e>0?D++:D--,a.startJSON.prev.y=D,a.startJSON.now.y=D,a.startJSON.next.y=D,a.transitions(C,e>0?-1:1)})}},t.prototype.transitions=function(e,t){e.classList.add("silde",t>0?"prev-to":"next-to"),setTimeout(function(){this.appendList(this.startJSON,function(){e.classList.remove("silde","prev-to","next-to"),this.addEvent()}.bind(this))}.bind(this),500)},t.prototype.selectDate=function(e,t,a,n){var r=this;this.startJSON.prev[a]="m"==a?n-1:n,this.startJSON.now[a]=n,this.startJSON.next[a]="m"==a?n+1:n,this.appendList(this.startJSON,r.addEvent.bind(this)),e.classList.add("active"),t.classList.remove("active"),m.show=!1,y.show=!1},t.prototype.changes=function(){var t=e.jQuery||e.$||null;t?t(this.currentNode)&&t(this.currentNode).change&&t(this.currentNode).change():this.currentNode.onchange&&this.currentNode.onchange()},e.addEventListener("load",function(){new t},!1),e.Calendar=t,t});